<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>ë‚˜ì˜ ë¬¸í™” ê¸°ë¡ & ì¼ê¸°ì¥</title>
  <style>
    body {
      font-family: 'Noto Sans KR', sans-serif;
      margin: 0;
      background: #f7f8fa;
      color: #333;
      display: flex;
      flex-direction: column;
      min-height: 100vh;
    }
    header {
      background: #4b6cb7;
      background: linear-gradient(to right, #182848, #4b6cb7);
      color: white;
      padding: 15px 20px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      font-size: 1.1em;
    }
    main {
      display: flex;
      flex: 1;
      padding: 15px;
      gap: 15px;
    }
    section {
      flex: 1;
      background: white;
      border-radius: 12px;
      padding: 15px;
      box-shadow: 0 2px 5px rgba(0,0,0,0.1);
      overflow-y: auto;
    }
    h2 {
      margin-top: 0;
      color: #4b6cb7;
    }
    input, select, textarea, button {
      width: 100%;
      margin-top: 6px;
      margin-bottom: 10px;
      padding: 8px;
      border: 1px solid #ccc;
      border-radius: 8px;
      font-size: 0.95em;
    }
    button {
      background-color: #4b6cb7;
      color: white;
      font-weight: bold;
      cursor: pointer;
      transition: 0.2s;
    }
    button:hover {
      background-color: #395b9a;
    }
    .review-item {
      border: 1px solid #ddd;
      padding: 10px;
      margin-top: 10px;
      border-radius: 8px;
      background: #fafafa;
    }
    .review-item h3 {
      margin: 5px 0;
    }
    ul {
      padding-left: 20px;
    }
    #review-section { flex: 2; }
    #diary-section { flex: 1; }
    footer {
      text-align: center;
      padding: 10px;
      background: #eee;
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <header>
    <span id="date"></span>
    <span id="weather">ë‚ ì”¨ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</span>
  </header>

  <main>
    <!-- ğŸ¬ ê°ìƒ ê¸°ë¡ -->
    <section id="review-section">
      <h2>ğŸ¬ ê°ìƒ ê¸°ë¡</h2>
      <input id="title" placeholder="ì œëª© ì…ë ¥" />
      <select id="rating">
        <option value="1">â­</option>
        <option value="2">â­â­</option>
        <option value="3">â­â­â­</option>
        <option value="4">â­â­â­â­</option>
        <option value="5">â­â­â­â­â­</option>
      </select>
      <textarea id="review" rows="3" placeholder="ê°ìƒí‰ì„ ì ì–´ë³´ì„¸ìš”"></textarea>
      <button id="addReview">ì¶”ê°€</button>

      <div id="reviewList"></div>
    </section>

    <!-- âœï¸ ì¼ê¸°ì¥ -->
    <section id="diary-section">
      <h2>ğŸ““ ë‚˜ì˜ ì¼ê¸°</h2>
      <textarea id="diaryText" rows="10" placeholder="ì˜¤ëŠ˜ì˜ ì¼ê¸°ë¥¼ ì ì–´ë³´ì„¸ìš”..."></textarea>
      <button id="saveDiary">ì €ì¥</button>
    </section>
  </main>

  <footer>
    Â© 2025 ë‚˜ì˜ ë¬¸í™” ê¸°ë¡ ì›¹ | HTML + CSS + JS ê³¼ì œ
  </footer>

  <script>
    // ------------------- ë‚ ì§œ í‘œì‹œ -------------------
    const today = new Date();
    const todayStr = today.toLocaleDateString('ko-KR', {
      year: 'numeric',
      month: 'long',
      day: 'numeric',
      weekday: 'short'
    });
    document.getElementById("date").textContent = todayStr;

    // ------------------- ë‚ ì”¨ API -------------------
    const weatherBox = document.getElementById("weather");
    const API_KEY = "YOUR_OPENWEATHER_API_KEY"; // â† ì—¬ê¸°ì— API í‚¤ ë„£ê¸°

    if (navigator.geolocation) {
      navigator.geolocation.getCurrentPosition(pos => {
        const { latitude, longitude } = pos.coords;
        fetch(`https://api.openweathermap.org/data/2.5/weather?lat=${latitude}&lon=${longitude}&appid=${API_KEY}&units=metric&lang=kr`)
          .then(res => res.json())
          .then(data => {
            const weather = data.weather[0].description;
            const temp = data.main.temp;
            weatherBox.textContent = `${weather} / ${temp.toFixed(1)}Â°C`;
          })
          .catch(() => {
            weatherBox.textContent = "ë‚ ì”¨ ì •ë³´ë¥¼ ë¶ˆëŸ¬ì˜¬ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.";
          });
      });
    } else {
      weatherBox.textContent = "ìœ„ì¹˜ ì ‘ê·¼ ë¶ˆê°€";
    }

    // ------------------- ê°ìƒ ê¸°ë¡ -------------------
    const addBtn = document.getElementById("addReview");
    addBtn.addEventListener("click", () => {
      const title = document.getElementById("title").value.trim();
      const rating = document.getElementById("rating").value;
      const review = document.getElementById("review").value.trim();

      if (!title || !review) {
        alert("ì œëª©ê³¼ ê°ìƒí‰ì„ ëª¨ë‘ ì…ë ¥í•´ì£¼ì„¸ìš”!");
        return;
      }

      const newReview = { title, rating, review, comments: [] };
      const reviews = JSON.parse(localStorage.getItem("reviews") || "[]");
      reviews.push(newReview);
      localStorage.setItem("reviews", JSON.stringify(reviews));

      document.getElementById("title").value = "";
      document.getElementById("review").value = "";

      showReviews();
    });

    function showReviews() {
      const list = document.getElementById("reviewList");
      const reviews = JSON.parse(localStorage.getItem("reviews") || "[]");
      list.innerHTML = "";

      reviews.forEach((r, i) => {
        list.innerHTML += `
          <div class="review-item">
            <h3>${r.title} (${r.rating}â­)</h3>
            <p>${r.review}</p>
            <input id="comment${i}" placeholder="ëŒ“ê¸€ ì‘ì„±">
            <button onclick="addComment(${i})">ë“±ë¡</button>
            <ul>${r.comments.map(c => `<li>${c}</li>`).join("")}</ul>
          </div>
        `;
      });
    }

    function addComment(index) {
      const reviews = JSON.parse(localStorage.getItem("reviews") || "[]");
      const input = document.getElementById(`comment${index}`);
      if (input.value.trim() !== "") {
        reviews[index].comments.push(input.value);
        localStorage.setItem("reviews", JSON.stringify(reviews));
        showReviews();
      }
    }

    showReviews();

    // ------------------- ì¼ê¸° ê¸°ëŠ¥ -------------------
    const diaryKey = `diary-${today.toISOString().split("T")[0]}`;
    const diaryText = document.getElementById("diaryText");

    document.getElementById("saveDiary").addEventListener("click", () => {
      localStorage.setItem(diaryKey, diaryText.value);
      alert("ì¼ê¸°ê°€ ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤!");
    });

    window.onload = () => {
      const saved = localStorage.getItem(diaryKey);
      if (saved) diaryText.value = saved;
    };
  </script>
</body>
</html>
